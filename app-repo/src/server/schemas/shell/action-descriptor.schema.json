{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "definitions": {
        "confirmationConfig": {
            "type": "object",
            "additionalProperties": false,
            "required": ["title", "message", "confirmLabel", "cancelLabel"],
            "properties": {
                "title": { "type": "string" },
                "message": { "type": "string" },
                "confirmLabel": { "type": "string" },
                "cancelLabel": { "type": "string" },
                "severity": { "type": "string", "enum": ["warning", "danger"] }
            }
        },
        "actionDescriptor": {
            "type": "object",
            "additionalProperties": false,
            "required": ["kind"],
            "properties": {
                "kind": { 
                    "type": "string",
                    "enum": ["navigate", "openWindow", "toggleOverlay", "command", "externalLink", "noop"]
                },
                "params": { "type": "object" },
                "destructive": { "type": "boolean" },
                "confirmation": { "$ref": "#/definitions/confirmationConfig" },
                "permissions": {
                    "type": "array",
                    "items": { "type": "string" }
                }
            },
            "if": {
                "properties": { "destructive": { "const": true } }
            },
            "then": {
                "required": ["confirmation"]
            },
            "allOf": [
                {
                    "if": { "properties": { "kind": { "const": "navigate" } } },
                    "then": {
                        "properties": {
                            "params": {
                                "type": "object",
                                "additionalProperties": false,
                                "anyOf": [
                                    { "required": ["path"] },
                                    { "required": ["routeId"] }
                                ],
                                "properties": {
                                    "path": { "type": "string" },
                                    "routeId": { "type": "string" },
                                    "params": { "type": "object" }
                                }
                            }
                        },
                        "required": ["params"]
                    }
                },
                {
                    "if": { "properties": { "kind": { "const": "openWindow" } } },
                    "then": {
                         "properties": {
                            "params": {
                                "type": "object",
                                "additionalProperties": false,
                                "required": ["windowKey", "mode"],
                                "properties": {
                                    "windowKey": { "type": "string" },
                                    "mode": { "type": "string", "enum": ["singleton", "multi"] }
                                }
                            }
                         },
                         "required": ["params"]
                    }
                },
                {
                    "if": { "properties": { "kind": { "const": "toggleOverlay" } } },
                    "then": {
                         "properties": {
                            "params": {
                                "type": "object",
                                "additionalProperties": false,
                                "required": ["overlayId"],
                                "properties": {
                                    "overlayId": { "type": "string" }
                                }
                            }
                         },
                         "required": ["params"]
                    }
                },
                {
                    "if": { "properties": { "kind": { "const": "command" } } },
                    "then": {
                         "properties": {
                            "params": {
                                "type": "object",
                                "additionalProperties": false,
                                "required": ["commandId"],
                                "properties": {
                                    "commandId": { "type": "string" },
                                    "args": { "type": "array" }
                                }
                            }
                         },
                         "required": ["params"]
                    }
                },
                {
                    "if": { "properties": { "kind": { "const": "externalLink" } } },
                    "then": {
                         "properties": {
                            "params": {
                                "type": "object",
                                "additionalProperties": false,
                                "required": ["url"],
                                "properties": {
                                    "url": { "type": "string" }
                                }
                            }
                         },
                         "required": ["params"]
                    }
                },
                {
                    "if": { "properties": { "kind": { "const": "noop" } } },
                    "then": {
                         "properties": {
                            "params": {
                                "type": "object",
                                "additionalProperties": false
                            }
                         }
                    }
                }
            ]
        }
    }
}
